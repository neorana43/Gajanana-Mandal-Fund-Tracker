-- Create a policy that allows users to delete their own expenses.
-- Also allows users with the 'admin' role to delete any expense.
CREATE POLICY "Users can delete their own expenses"
ON public.expenses
FOR DELETE
USING (
  -- The user's ID must match the user_id on the expense record
  auth.uid() = user_id
  -- OR, the user must have the 'admin' role
  OR (
    SELECT role
    FROM public.user_roles
    WHERE id = auth.uid()
  ) = 'admin'
);